# Template file for 'qmlfmt'
pkgname=qmlfmt
version=1.1.4.git.2896d71
revision=1
build_style=cmake
hostmakedepends="git cmake unzip qt6-qttools"
makedepends="qt6-qtbase-devel qt6-qt5compat-devel"
depends="qt6-qt5compat"
short_desc="Formatter for Qt/QML code (git, pinned commit)"
maintainer="lysec <itslysec@gmail.com>"
license="MIT"
homepage="https://github.com/jesperhh/qmlfmt"
changelog="https://github.com/jesperhh/qmlfmt/releases"
skip_hash=yes

_giturl="https://github.com/jesperhh/qmlfmt.git"
_gitrev="2896d71a14d0232d43816f7e99482f5bf0385dab"

do_fetch() {
    rm -rf "${wrksrc}"
    git clone --depth=1 "${_giturl}" "${wrksrc}"
    cd "${wrksrc}"
    git fetch --depth=1 origin "${_gitrev}"
    git checkout "${_gitrev}"
}

pre_configure() {
    # Create dummy QtCreatorIDEBranding.cmake to satisfy CMake
    mkdir -p "${wrksrc}/qt-creator/cmake"
    cat > "${wrksrc}/qt-creator/cmake/QtCreatorIDEBranding.cmake" << EOF
# Dummy file for qmlfmt build
set(QTC_IDE_BRANDING "")
EOF
}

configure_args="
    -DCMAKE_PREFIX_PATH=/usr/lib/qt6
    -DQt6_DIR=/usr/lib/qt6/cmake/Qt6
"
